<?php

/**
 * Created by PhpStorm.
 * User: arvin
 * Date: 2016/1/16
 * Time: 22:57
 */
class Exploit_model extends CI_Model {
    /*
     * exploit数据库格式
     * id               1
     * vendor           "D-Link"
     * module           "DIR-810L"
     * version          "1.12-1.14"
     * type_exploit     "Buffer overflow"
     * ref              "https://www.exploit-db.com/exploits/33737/,https://www.exploit-db.com/exploits/33737/"
     * update           time()
     * verify           false
     * poc              import re ...
     * poc_language     python
     *
    */

    public function __construct() {
        parent::__construct();
    }

    /**
     * @param $exploit_id 查找的exploit的id
     * @return null: 未找到该id的exploit, exploit:找到的exploit对象
     */
    public function get_entry($exploit_id) {
        $exploit = $this->db->get_where("exploits", array("id" => $exploit_id))->row();

        if (!$exploit) {
            // 不存在该id的exploit
            return null;
        }
        else {
            $exploit->ref = explode(",",$exploit->ref);
//            $exploit->poc = explode("\n", $exploit->poc);
            return $exploit;
        }
    }
}