<?php
/**
 * Created by PhpStorm.
 * User: arvin
 * Date: 2016/1/16
 * Time: 18:37
 */

defined('BASEPATH') or exit('No direct script access allowed');
?>

<!--prism resource-->
<link rel="stylesheet" href="<?=base_url().'resource/prism/prism.css'?>">
<script src="<?=base_url().'resource/prism/prism.js'?>"></script>

<div class="container">
    <h1 class="exploit-title"><?=$exploit->title?></h1>
    <hr>
    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <label class="exploit-label">编号: RE-<?=$exploit->id?></label>
            <br>
            <label class="exploit-label">品牌: <?=$exploit->vendor?></label>
            <br>
            <label class="exploit-label">型号: <?=$exploit->module?></label>
            <br>
            <label class="exploit-label">适用版本: <?=$exploit->version?></label>
            <br>
            <label class="exploit-label">类型: <?=$exploit->type_exploit?></label>
            <br>
            <label class="exploit-label">Refer:
                <?php foreach ($exploit->ref as $ref_url): ?>
                    <a class="exploit-href" href=<?=$ref_url?>><?=$ref_url?></a>&nbsp;
                <?php endforeach; ?>
            </label>
            <br>
            <label class="exploit-label">更新时间: <?=date("Y-m-d h:i", $exploit->update)?></label>
            <br>
            <label class="exploit-label"><a href="/exploit/download_exploit?id=<?=$exploit->id?>" >下载POC</a></label>
        </div>

        </div>
        <div class="col-md-10 col-md-offset-1">
            <hr>
            <!--!!! 由于有<pre> tag, 这里的缩进不能更改-->
            <pre>
                <code class="language-<?=$exploit->poc_language?> line-numbers">
        <?php $exploit->poc = explode("\n", $exploit->poc);
        // 不能直接echo poc段，否则缩进出现问题，只能将poc段按换行符分割后输出
        foreach ($exploit->poc as $poc_line): ?>
            <?=$poc_line?>
        <?php endforeach; ?>
                </code>
            </pre>
        </div>
    </div>
</div>

